<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        function preOrder(ecuacion, raiz){
            if(raiz.agregado == false){
                ecuacion += raiz.valor;
                raiz.agregado = true;
                return preOrder(ecuacion, raiz);
            }else if(raiz.izq != null && raiz.izq.agregado == false){
                raiz = raiz.izq;
                return preOrder(ecuacion, raiz);
            }else if(raiz.der != null && raiz.der.agregado == false){
                raiz = raiz.der;
                return preOrder(ecuacion, raiz);
            }else if(raiz.ant != null){
                raiz = raiz.ant;
                return preOrder(ecuacion, raiz);
            }else{
                return ecuacion;
            }
        }
        function postOrder(ecuacion, raiz){
            if(raiz.izq != null && raiz.izq.agregado == false){
                raiz = raiz.izq;
                return postOrder(ecuacion, raiz);
            }else if(raiz.der != null && raiz.der.agregado == false){
                raiz = raiz.der;
                return postOrder(ecuacion, raiz);
            }else if(raiz.agregado == false){
                ecuacion += raiz.valor;
                raiz.agregado = true;
                return postOrder(ecuacion, raiz);
            }else if(raiz.ant != null){
                raiz = raiz.ant;
                return postOrder(ecuacion, raiz);
            }else{
                return ecuacion;
            }
        }
        function preOrderOperation(ecuacion){
            let auxArray = [];
            let resultado = 0;

            for(let i = ecuacion.length-1, j = 0; i >= 0; i--, j++){
                switch(ecuacion.charAt(i)){
                    case '/':
                        auxArray.push(parseInt(auxArray[j-1]/auxArray[j-2]));
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '*':
                        auxArray.push(parseInt(auxArray[j-1]*auxArray[j-2]))
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '+':
                        auxArray.push(parseInt(auxArray[j-1]+auxArray[j-2]))
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '-':
                        auxArray.push(parseInt(auxArray[j-1]-auxArray[j-2]))
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    default:
                        auxArray.push(parseInt(ecuacion.charAt(i)));
                        break;
                }
            }
            resultado = auxArray[0];
            return resultado;
        }
         function postOrderOperation(ecuacion){
            let auxArray = [];
            let resultado = 0;

                for(let i = 0, j = 0; i < ecuacion.length; i++, j++){
                switch(ecuacion.charAt(i)){
                    case '/':
                        auxArray.push(parseInt(auxArray[j-2]/auxArray[j-1]));
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '*':
                        auxArray.push(parseInt(auxArray[j-2]*auxArray[j-1]));
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '+':
                        auxArray.push(parseInt(auxArray[j-2]+auxArray[j-1]));
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    case '-':
                        auxArray.push(parseInt(auxArray[j-2]-auxArray[j-1]));
                        auxArray.splice(j-1, 1);
                        auxArray.splice(j-2, 1);
                        j -= 2;
                        break;
                    default:
                        auxArray.push(parseInt(ecuacion.charAt(i)));
                        break;
                }
            }
            resultado = auxArray[0];
            return resultado;
        }
        class ArbolBinario{
            constructor(){
                this.raiz = null;
            }
            construir(ecuacion){
                let nuevoArray = [];
                let auxArray = [];
                let temp = null;

                for(let i = 0; i < ecuacion.length; i++){
                    auxArray[i] = new Nodo(ecuacion.charAt(i));
                }
                for(let i = 0; i < auxArray.length; i++){    
                    if(auxArray[i].valor == '/' || auxArray[i].valor == '*'){
                        temp = auxArray[i];
                        this.raiz = temp;
                        temp.izq = auxArray[i-1];
                        temp.izq.ant = temp;
                        temp.der = auxArray[i+1];
                        temp.der.ant = temp;
                        auxArray.splice(i+1, 1);
                        auxArray.splice(i-1, 1);
                        i -= 1;
                    }
                }
                for(let i = 0; i < auxArray.length; i++){    
                    if(auxArray[i].valor == '+' || auxArray[i].valor == '-'){
                        temp = auxArray[i];
                        this.raiz = temp;
                        temp.izq = auxArray[i-1];
                        temp.izq.ant = temp;
                        temp.der = auxArray[i+1];
                        temp.der.ant = temp;
                        auxArray.splice(i+1, 1);
                        auxArray.splice(i-1, 1);
                        i -= 1;
                    }
                }
                return ;
            }
        }
        class Nodo{
            constructor(valor){
                this.valor = valor;
                this.der = null;
                this.izq = null;
                this.ant = null;
                this.agregado = false;
            }
        }

        let miArbolBinario = new ArbolBinario();
        let miEcuacion1 = prompt("Introduce una ecuacion: ");
        miArbolBinario.construir(miEcuacion1);

        let miEcuacion2 = "";

        const ecuacionPreOrder = preOrder(miEcuacion2, miArbolBinario.raiz);
        console.log(ecuacionPreOrder);
        let resultado1 = "";
        resultado1 = preOrderOperation(ecuacionPreOrder);
        console.log(resultado1);
    </script>
</body>
</html>